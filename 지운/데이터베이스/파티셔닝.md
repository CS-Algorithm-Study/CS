# 파티셔닝


## 목차
1. 개념
2. 분류
3. 분할 기준에 따른 종류

---

## 1. 개념
- 파티셔닝(Partitioning) 배경
  - 서비스의 규모가 커지면서 DB에 저장되는 데이터의 규모도 커짐
  → Very Large DBMS와 같이 큰 테이블이 DBMS에 저장되는 상황, 용량과 성능 이슈 발생
  → **테이블**을 **파티션**이라는 작은 단위로 **나누어 관리**
- 목적
  - 성능 향상
    - Full Scan 시 데이터 탐색 범위 축소
    - INSERT, UPDATE 작업을 작은 단위로 분산시킴으로써 경합 감소 및 성능 향상
  - 가용성
    - 전체 데이터의 훼손 가능성 감소 및 데이터 가용성 향상
    - 분리된 파티션은 독립적인 백업 및 복구 가능
  - 관리용이성
    - 테이블의 규모가 작아지므로 관리 용이
- 장점
  - 관리 측면 : 파티션 단위의 write
  - 성능 측면 : 파티션 단위의 조회 및 DML
- 단점
  - 테이블 간 조인 비용 증가
  - 테이블과 인덱스는 같이 파티셔닝해야만 함

---

## 2. 분류
### 수평 파티셔닝
- 테이블의 각 행을 다른 테이블에 분산
![수평 파티셔닝](https://github.com/Central-MakeUs/BlueClub-Server/assets/90232934/64885239-b0ee-4a93-8d30-61e6d0a8ab28)
- 특징
  - 가용성을 위해 key 기반으로 분산 저장
  - 일반적으로 하나의 DB 안에서 발생
- 장점
  - 데이터의 개수를 기준으로 분리
    → 인덱스의 수가 작아지면서 성능 향상
- 단점
  - 서버 간 연결과정 증가
  - 데이터 탐색 과정 복잡성으로 인한 지연 시간 증가
  - 한 서버의 작동이 중단되면 데이터 무결성 발생 가능
### 수직 파티셔닝
- 테이블의 일부 열을 다른 테이블에 분산
![image](https://github.com/Central-MakeUs/BlueClub-Server/assets/90232934/b0e59238-e341-4927-8272-9b7e861da62a)
- 특징
  - 제3정규화와 유사한 개념
  - 정규화된 데이터를 분리하는 과정
- 장점
  - 자주 사용하는 column을 분리해 성능 향상
  - 한 테이블 select 시 모든 column이 메모리에 올라가 한 번에 읽을 수 있는 row가 줄어들게 되는데, 해당 기법 사용 시 불필요한 column이 최소화된 상태로 메모리에 올라가므로 성능 향상
  - 같은 타입의 데이터가 저장되므로 데이터 압축률 증가
- 단점
  - 데이터 탐색 과정 복잡성으로 인한 지연 시간 증가

---

## 3. 분할 기준에 따른 종류
![분할](https://github.com/Central-MakeUs/BlueClub-Server/assets/90232934/de3e39d8-9b4c-41ac-a440-00877f758ac1)
### 범위 분할
- 연속적인 숫자, 날짜 등을 기준으로 파티셔닝
- 분할 키 값의 범위 내 존재 여부로 구분
- 우편 번호, 날짜 등 데이터에 유용
### 목록 분할
- 미리 기준이 되는 값 목록에 파티션 할당 후, 분할 키 값이 해당 목록을 통해 해당되는 파티션으로 선택
- 특정 파티션에 저장될 데이터에 대한 명시적 제어 가능
- 분포도가 비슷하고 해당 column의 조건이 많이 들어올 때 유용
### 해시 분할
- 파티션 key의 해시 값을 기준으로 파티셔닝
- 해시 함수 값에 따라 파티션 포함 여부 결정
- 균등한 데이터 분할
- 특정 데이터가 어느 해시 파티션에 있는지 판단 어려움
- 파티션을 위한 범위가 없는 데이터에 유용
### 합성 분할
- 파티션의 서브파티셔닝, 즉 앞의 분할을 적절히 결합해 사용
- 큰 파티션에 대한 I/O 요청을 여러 작은 파티션으로 분산
